import google.generativeai as genai
from fastapi import FastAPI, Body
from pydantic import BaseModel
import os

model = genai.GenerativeModel(model_name="gemini-1.0-pro")
api_key = os.getenv('GOOGLE_AI_KEY')
genai.configure(api_key=f'{api_key}')


def check_resume(resume : str = Body(...)) -> str :
    convo = model.start_chat(history=[
  {
    "role": "user",
    "parts": ["You are an expert in resume making . Below are the points you have to follow while making resume .1) Quantify impact (Numbers in bullet points eg . '30%' sales increased and etc)2) No Repeatation of words3) You should remove weak action verbs from your resume.4) you can use both the present and/or past tense to describe your current job. However, you should always use the past tense when describing your previous experiences and achievements.5) Avoided Responsibility-oriented Words. Your resume should focus on your accomplishments, not your responsibilities6) Avoid Spelling mistakes7) Top student resumes are between 450 and 650 words long.8) Avoid using paragraphs. Use bullet points instead.9) You should have 12 bullets points altogether in your project section10) Each of your bullet points should be between 10 and 30 words long11) Even if your bullet point is within that range, remember that it should not exceed two lines on your resume (visually).12) Remove superfluous words that take up space and add little value eg.   Before : Carried out evaluations of various strategies in order to save clients $200k in fixed costs...After (Fillers removed) : Evaluated 15+ strategies to save clients $200k in fixed costs...13) Remove vague buzzwords which add little value eg .passionate , dynamic14) No unnecessary business jargon eg.BEFORE: WITH BUZZWORDS• Highly motivated individual with strong leadership and management skills, with extensive experience managing cross-functional teamsAFTER: NO BUZZWORDS• Managed a 5-member cross-functional (product, engineering, sales, support) team and coordinated with six business partners toward the successful launch of an e-commerce platform.15) Make sure your dates are formatted correctly eg . feburary 2020 - Till Date , December 2021 - October 20232016-2017 (just years), You should be consistent with your date formats.16) In terms of personal details, your resume should contain your name, location, and key contact details (e.g. your email). You should avoid adding in other personal details, like date of birth, gender or nationality. Let's look at a few personal detail checks.17) A good filename looks like Jane-Smith-Resume.pdf or Jane-Smith-Resume.docx.18) Remove any personal pronouns from your resume eg.BeforeI managed a 5-member cross-functional (product, engineering, sales, support) team and we coordinated with my company's six business partners toward the successful launch of our e-commerce platform.AfterManaged a 5-member cross-functional (product, engineering, sales, support) team and coordinated with six business partners toward the successful launch of an e-commerce platform.19) Make sure you avoid the passive voice in your bullet points20) Ensure your bullet points are consistent in punctuation and formatting.21) Summary are only appropriate for mid- to senior-level applicants, or career changers, but not entry-level applicants.22) Get your education section in shape, plus see proven examples23) A skills section is a short, optional resume section that can be used to include technical and hard skills that you have, especially if you haven’t been able to include them elsewhere in your resume.24) Communication , Employers want someone that can clearly communicate with anyone the job requires them to - whether that is a key stakeholder, team member or client.You should add more examples of communication skills on your resume.25) Leadership ,Employers want to know if you can own a project, manage a team and take responsibility .Involve evidence of leadership.26) Analytical and Problem-solving ,Analytical skills refer to your ability to break down complex problems, evaluate them effectively, and come up with appropriate solutions.27) Teamwork , Employers want to know if you can work effectively with others to achieve common goals .Involve evidence of teamwork.28) Drive and Initiative ,Employees who show strong initiative are characterized by their proactivity, self-starting nature and persistence in solving difficult problems. Not enough drive and initiative demonstrated.29) Dont use embedded link . Use full link as string if neccesaryyou have to make sure all these points are folllowed . Remeber these are complusory keypoints in making a ats optimized resume . If you find anything against it you have to correct it and rewrite all the resume from start . Below is the resume . Analyze it and improve if nessasry."]
  },
  {
    "role": "model",
    "parts": ["## Resume Analysis and Improvement Process\n\nI'm ready to analyze the resume you provide and improve it based on the 29 key points you've outlined. Please share the resume content, and I'll carefully review it, making necessary adjustments to optimize it for ATS systems and ensure it effectively showcases the candidate's skills and experiences. \n\n**Here's how I'll approach the analysis and improvement:**\n\n1. **Quantifiable Impact:** I'll ensure each bullet point includes quantifiable metrics to demonstrate the impact of the candidate's actions. \n2. **Word Repetition:** I'll eliminate repetitive words and phrases to maintain conciseness and variety.\n3. **Action Verbs:** Weak action verbs will be replaced with strong, impactful alternatives that highlight achievements.\n4. **Tense Consistency:** I'll ensure past tense is used for previous experiences and present tense for the current role.\n5. **Accomplishment Focus:** The resume will be revised to emphasize accomplishments rather than responsibilities.\n6. **Spelling and Grammar:** Thorough proofreading will eliminate any spelling or grammatical errors.\n7. **Word Count:** The resume length will be adjusted to fall within the optimal range of 450-650 words.\n8. **Bullet Points:** Paragraphs will be converted into concise bullet points for improved readability. \n9. **Project Section Length:** The project section will be reviewed to ensure it contains approximately 12 bullet points.\n10. **Bullet Point Length:** Each bullet point will be edited to adhere to the 10-30 word range and two-line visual limit.\n11. **Filler Words:** Superfluous words will be removed to maintain a concise and impactful writing style.\n12. **Buzzwords:** Vague buzzwords like \"passionate\" or \"dynamic\" will be eliminated.\n13. **Business Jargon:** Unnecessary business jargon will be replaced with clear and concise language.\n14. **Date Formatting:** Dates will be formatted consistently throughout the resume. \n15. **Personal Details:** The resume will only include essential personal details, such as name,"]
  },
  
])

    convo.send_message(f"""Remeber these are complusory keypoints in making a ats optimized resume .
                        If you find anything against it you have to correct it and rewrite all the
                        resume from start.Below is the resume . Analyze it and improve if nessasry.
                         {resume}""")
    response1 = (convo.last.text)

    return response1